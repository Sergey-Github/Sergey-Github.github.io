<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
</head>
<body>
	<h1>15. Средства идентификации и аутентификации
</h1>
<p>Реализация конкретных моделей защиты от несанкционированного доступа должна опираться на
соответствующие административные (процедурные) мероприятия и технические средства,
направленные в первую очередь на идентификацию и аутентификацию пользователей
автоматизированной системы.
<p>Идентификация пользователей АС заключается в установлении и закреплении за каждым из них
уникального идентификатора в виде номера, шифра, кода и т.п.
<p>Аутентификация заключается в проверке подлинности пользователя по предъявленному им
идентификатору, например, при входе в систему. Такая проверка должна исключать
фальсификацию пользователей в системе и их компрометацию. Без проверки подлинности
теряется смысл в самой идентификации пользователей и применении средств разграниче- ния
доступа, построенных на базе личных идентификаторов.
<p>В настоящее время в автоматизированных системах используются три основных способа
аутентификации по следующим признакам: паролю или личному идентифицирующему номеру;
некоторому предмету, который есть у пользователя; каким-либо физиологическим признакам,
свойственным конкретным лицам.
<p>Суть первого способа заключается в том, что пользователь знает и хранит в тайне персональный
пароль, который вводится по требованию автоматизированной системы. Она сравнивает пароль
(либо хэш) и по результатам проверки выдает решение об аутентификации. В качестве предмета,
имеющегося у пользователя (второй способ аутентификации), применяются, например, так
называемые карты идентификации (КИ), на которые наносятся данные, персонифицирующие
пользователя:, персональный идентификационный номер, специальный шифр или код и т. п. Эти
данные заносятся на карточку в зашифрованном виде, причем ключ шифрования может быть
дополнительным идентифицирующим параметром, поскольку он может быть известен только
пользователю, вводится им каждый раз при обращении к системе и уничтожается сразу же после
использования. Большое распространение получают системы, использующие физиологические
признаки организма для аутентификации. Наиболее распространенные из них: отпечатки пальцев,
форма кисти, голос, радужная оболочка глаза, подпись.
<p>Протокол PAP (Password Authentication Protocol) - протокол простой проверки подлинности,
предусматривающий отправку имени пользователя и пароля на сервер удалённого доступа
открытым текстом (без шифрования). Протокол PAP крайне ненадёжен, поскольку пересылаемые
пароли можно легко читать в пакетах PPP, которыми обмениваются стороны в ходе проверки
подлинности.
<p>Протокол Kerberos. Протокол основан на понятии билета (ticket). Билет является зашифрованным
пакетом данных, который выдается доверенным центром аутентификации (KDC). Когда
пользователь выполняет первичную аутентификацию, после успешного подтверждения его
подлинности KDC выдает первичное удостоверение 29 пользователя для доступа к сетевым
ресурсам — Ticket Granting Ticket (TGT). В дальнейшем, при обращении к отдельным ресурсам
сети, пользователь, предъявляя TGT, получает от KDC удостоверение для доступа к конкретному
сетевому ресурсу — Service Ticket (TGS). Процесс аутентификации:
<p>1) Получив приглашение на ввод имени пользователя, пароля и домена, пользователь указывает
эти данные.
<p>2) Компьютер пользователя обращается к службе KDC и передает ей имя пользователя, имя
домена, а также текущее время на рабочей станции пользователя, при этом имя пользователя
передается в открытом виде, текущее время на рабочей станции пользователя передается в 
зашифрованном виде и является аутентификатором. Ключ шифрования формируется из пароля
пользователя в результате хеширования.
<p>3) Служба KDC ищет пользователя, выявляет мастер ключ пользователя, который основан на
пароле пользователя и расшифровывает аутентификатор, т. е. получает время отправки запроса.
Разница во времени отправки запроса и текущего времени на контроллере домена не должно
превышать определенного значения, установленного политикой протокола Kerberos.
<p>4) KDC создает 2 объекта: ключ сессии, посредством которого, посредством которого будет
шифроваться обмен между клиентом и KDC, и билет на получение билета TGT, включающий в себя
копию ключа сессии, имя пользователя, время окончания жизни билета. TGT зашифрован мастер
ключом KDC, известным только ей.
<p>5) Служба KDC зашифровывает аутентификатор пользователя (time stamp) и ключ сессии с
помощью ключа клиента. После этого эти данные отправляются клиенту.
<p>6) Компьютер клиента получает информацию от службы KDC, проверяет аутентификатор,
расшифровывает ключ сессии.
<p>7) Теперь клиент обладает ключом сессии и TGT, что предоставляет возможность безопасного
взаимодействия со службой KDC. Клиент аутентифицирован в домене и получает возможность
осуществлять доступ к ресурсам домена, используя протокол Kerberos.
<p>Получение доступа к другим ресурсам:
<p>1. Клиент обращается к службе KDC. Клиент представляет KDC свой TGT и маркер времени,
которые зашифрованы с помощью ключа сессии, известного службе KDC.
<p>2. KDC расшифровывает TGT, используя свой собственный ключ. Маркер времени
расшифровывается с помощью сессионного ключа. Теперь KDC может подтвердить, что запрос
пришел от «правильного» пользователя, т. к. этот пользователь может использовать этот
сессионный ключ.
<p>3. KDC создает пару билетов, один для клиента, один для сервера, к ресурсам которого клиент
должен будет получать доступ. Каждый билет содержит имя пользователя, запрашивающего
доступ, получателя запроса, маркер времени, показывающий, когда был создан билет, а также
срок жизни билета. Оба билета будут также содержать новый ключ, K_cs который, таким образом
известен и клиенту и серверу. Этот ключ будет обеспечивать возможность безопасного
взаимодействия между ними. KDC шифрует билет сервера, используя мастер – 30 ключ сервера,
затем вкладывает билет сервера внутрь билета клиента, который также содержит ключ K_cs.
<p>4. Вся эта структура зашифровывается с помощью сессионного ключа, который стал доступен
пользователю при аутентификации. После чего эта информация отправляется клиенту.
<p>5. Получив билет, клиент расшифровывает его с помощью сессионного ключа, т. е. K_cs становится
доступным клиенту, K_cs доступен также и серверу. Клиент не может прочитать билет сервера, т.
к. он зашифрован на ключе сервера.
<p>6. Клиент зашифровывает маркер времени с помощью ключа K_cs, затем отправляет маркер
времени и билет сервера самому серверу, к ресурсам которого пытается получить доступ.
<p>7. Получив эту информацию, на первом этапе сервер расшифровывает свой билет, используя свой
долговременный ключ. Это предоставляет возможность получить доступ к K_cs , с помощью
которого будет на втором этапе расшифрован маркер времени, полученный от клиента.
<p>8. Теперь и клиент, и сервер обладают ключом K_cs.
</body>
</html>